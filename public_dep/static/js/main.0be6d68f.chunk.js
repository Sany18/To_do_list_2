(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{49:function(e,t,a){e.exports=a(92)},90:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),l=a(18),r=a.n(l),o=a(9),c=a(10),i=a(13),u=a(11),d=a(12),m="http://localhost:3000",h={root:m,tasksGet:m+"/tasks",taskCreatePost:m+"/tasks/",taskShowGet:m+"/tasks/",taskUpdatePut:m+"/tasks/",taskUpdatePatch:m+"/tasks/",taskDelete:m+"/tasks/",deleteSelected:m+"/task/delete_selected/",statusSwitchGet:m+"/task/status_switch/",oauthTokenPOST:m+"/oauth/token/"},k=a(17),p=a(16),g=a(15),f=a(94),E=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).emptyTaskKey=function(){return!isNaN(parseFloat(a.props.taskKey))&&isFinite(a.props.taskKey)},a.getDateNow=function(){var e=new Date;return t(e.getFullYear())+"-"+t(e.getMonth())+"-"+t(e.getDate());function t(e){return null===e?"x":e<10?"0"+e:e}},a.state={isLoading:!1,error:null,tasks:[],taskKey:a.props.taskKey,value:{id:"",title:"",theme:"",priority:0,due_date:""}},a.handleChange=a.handleChange.bind(Object(g.a)(Object(g.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.emptyTaskKey()){var t="access_token="+localStorage.getItem("access_token");fetch(h.tasksGet+"?"+t).then(function(e){return e.json()}).then(function(t){return e.setState({tasks:t,isLoading:!0})}).then(function(t){var a=e.state.tasks[e.state.taskKey];e.setState({value:Object(p.a)({},e.state.value,{title:a.title})}),e.setState({value:Object(p.a)({},e.state.value,{theme:a.theme})}),e.setState({value:Object(p.a)({},e.state.value,{due_date:a.due_date})}),e.setState({value:Object(p.a)({},e.state.value,{id:a.id})})}).catch(function(t){return e.setState({error:t})})}}},{key:"handleChange",value:function(e){var t=e.target.value;this.setState({value:Object(p.a)({},this.state.value,Object(k.a)({},e.target.name,t))})}},{key:"render",value:function(){var e=this.state.tasks[this.state.taskKey]||this.state.value;return this.state.isLoading||!this.emptyTaskKey()?s.a.createElement("div",null,s.a.createElement("label",null,"Theme"),s.a.createElement("input",{defaultValue:e.title,name:"title",onChange:this.handleChange}),s.a.createElement("label",null,"Task"),s.a.createElement("textarea",{defaultValue:e.theme,name:"theme",onChange:this.handleChange}),s.a.createElement("label",null,"Due date"),s.a.createElement("input",{type:"date",defaultValue:e.due_date||this.getDateNow(),min:this.getDateNow(),name:"due_date",onChange:this.handleChange}),s.a.createElement(f.a,null,e.id?s.a.createElement(b,{type:"deleteTask",params:e.id}):"",s.a.createElement(b,{type:"closeTask"}),+this.state.value.id?s.a.createElement(b,{type:"updateTask",params:this.state.value}):s.a.createElement(b,{type:"saveTask",params:this.state.value}))):this.state.error?(document.getElementById("notice").innerHTML=this.state.error.toString(),null):null}}]),t}(n.Component),v=a(93),y=(a(88),a(100)),T=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={error:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{id:"event"},s.a.createElement(y.a,{bsStyle:"warning"},s.a.createElement("strong",null,this.props.val)))}}]),t}(n.Component),b=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={isLoading:!1,error:null,resp:[],type:null},a.ajaxTo=function(e,t,n){var l={method:n,headers:{"Content-Type":"application/json"},body:a.getTokensBody(t)};console.log("request: ",l),fetch(e,l).then(function(e){return e.json()}).then(function(e){e.access_token&&localStorage.setItem("access_token",e.access_token),r.a.render(s.a.createElement(T,{val:e.error}),document.getElementById("notice")),console.log("response: ",e),a.refreshTasks()}).catch(function(e){return a.setState({error:e})})},a.getTokensBody=function(e){return"password"===e.grant_type?JSON.stringify(e):localStorage.getItem("access_token")?(e.access_token=localStorage.getItem("access_token"),JSON.stringify(e)):JSON.stringify({access_token:localStorage.getItem("access_token")})},a.openNewTaskModal=function(){a.openTaskInModal(!1)},a.openTaskInModal=function(e){a.hideModal(),document.getElementById("modal").hidden=!1;var t=document.createElement("div");document.getElementById("modal").appendChild(t),r.a.render(s.a.createElement(E,{taskKey:e}),t)},a.hideModal=function(){if(!document.getElementById("modal").hidden){var e=document.getElementById("modal");e.firstChild&&r.a.unmountComponentAtNode(e.firstChild),e.innerHTML="",e.hidden=!0}},a.saveTask=function(e){a.ajaxTo(h.taskCreatePost,{task:e},"POST"),a.hideModal()},a.updateTask=function(e){a.ajaxTo(h.taskUpdatePut+e.id,{task:e},"PUT"),a.hideModal()},a.login=function(e){e.grant_type="password",a.ajaxTo(h.oauthTokenPOST,e,"POST")},a.refreshTasks=function(){localStorage.setItem("taps",+localStorage.getItem("taps")+1)},a.deleteTask=function(e){a.ajaxTo(h.taskDelete+e,{},"DELETE"),a.hideModal()},a.getButton=function(e,t){switch(e){case"deleteTask":return s.a.createElement(v.a,{onClick:function(){return a.deleteTask(t)}},"Delete task");case"deleteTask2":return s.a.createElement(v.a,{onClick:function(){return a.deleteTask(t)}},"\xd7");case"deleteTasks":return s.a.createElement(v.a,{onClick:function(){return console.log(h.deleteSelected+t)}},"Delete selected");case"editTask":return s.a.createElement(v.a,{onClick:function(){return a.openTaskInModal(t)}},"Edit");case"createTask":case"newTask":return s.a.createElement(v.a,{bsStyle:"default",onClick:function(){return a.openNewTaskModal()}},"New task");case"closeTask":return s.a.createElement(v.a,{onClick:function(){return a.hideModal()}},"Close");case"saveTask":return s.a.createElement(v.a,{onClick:function(){return a.saveTask(t)}},"Save");case"updateTask":return s.a.createElement(v.a,{onClick:function(){return a.updateTask(t)}},"Update");case"signUp":return s.a.createElement(v.a,{onClick:function(){return console.log("coming soon")}},"Sign up");case"signIn":return s.a.createElement(v.a,{onClick:function(){return a.login(t)}},"Sign in");case"logOut":return s.a.createElement(v.a,{onClick:function(){return localStorage.removeItem("access_token")}},"Log out");default:return document.getElementById("notice").innerHTML="Button is undefined",null}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(f.a,{bsSize:"small"},this.getButton(this.props.type,this.props.params))}}]),t}(n.Component),S=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={isLoading:!1,error:null,isOpen:!1,tasks:[],taps:0},a.getTasks=function(){var e="access_token="+localStorage.getItem("access_token");fetch(h.tasksGet+"?"+e).then(function(e){return e.json()}).then(function(e){return a.setState({tasks:e,isLoading:!0})}).catch(function(e){return a.setState({error:e})})},a.handleClick=function(){a.setState({isOpen:!a.state.isOpen})},a.cutDate=function(e){return null===e?"free":e.substr(0,10)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.state.taps!==+localStorage.getItem("taps")&&(this.getTasks(),console.log("update!"),this.setState({taps:+localStorage.getItem("taps")}))}},{key:"componentDidMount",value:function(){this.getTasks(),this.setState({taps:+localStorage.getItem("taps")})}},{key:"render",value:function(){var e=this;return this.state.isLoading&&this.state.tasks.length?s.a.createElement("div",null,this.state.tasks.map(function(t,a){return s.a.createElement("ul",{className:"list-group",key:a},s.a.createElement("li",{className:"list-group-item list-group-item-success mr-2"},s.a.createElement("div",{className:"float-left"},s.a.createElement("b",null,t.title),s.a.createElement("br",null),t.theme),s.a.createElement("div",{className:"text-right float-right"},s.a.createElement("div",{className:"d-inline"},"Due date: ",e.cutDate(t.due_date)," "),s.a.createElement(f.a,null,s.a.createElement(b,{type:"editTask",params:a}),s.a.createElement(b,{type:"deleteTask2",params:t.id})))))})):this.state.isLoading&&!this.state.tasks.length?s.a.createElement("div",null,s.a.createElement("p",null,"Creare you first task")):this.state.error?(document.getElementById("notice").innerHTML=this.state.error.toString(),null):s.a.createElement("div",null,s.a.createElement("p",null,"Wait"))}}]),t}(n.Component);var O=function(e){return s.a.createElement("h2",{className:"mr-2",id:"clock"},"Now is ",(new Date).toLocaleTimeString()+" "+(new Date).toLocaleDateString())},j=a(95),C=a(96),I=a(99),w=a(97),_=a(98),N=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={isLoading:!0,error:null,tasks:[],value:{email:"",password:""}},a.handleChange=a.handleChange.bind(Object(g.a)(Object(g.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){var t=e.target.value;this.setState({value:Object(p.a)({},this.state.value,Object(k.a)({},e.target.name,t))})}},{key:"render",value:function(){return this.state.isLoading?s.a.createElement("div",null,s.a.createElement(j.a,null,s.a.createElement(C.a,null,s.a.createElement(I.a,{controlId:"formInlineName"},s.a.createElement(w.a,null,"Email"),s.a.createElement(_.a,{bsSize:"small",type:"text",name:"email",placeholder:"email",onChange:this.handleChange})),s.a.createElement(I.a,{controlId:"formInlineEmail"},s.a.createElement(w.a,null,"Password"),s.a.createElement(_.a,{bsSize:"small",name:"password",type:"password",placeholder:"password",onChange:this.handleChange})),s.a.createElement(b,{type:"signIn",params:this.state.value}),s.a.createElement(b,{type:"signUp"})))):this.state.error?(document.getElementById("notice").innerHTML=this.state.error.toString(),null):void 0}}]),t}(n.Component);a(90);function D(){return localStorage.access_token?s.a.createElement("div",{className:"mb-2 ml-2"},s.a.createElement("h1",{id:"site_name"},"Task list")," ",s.a.createElement(O,null),s.a.createElement("div",{className:"mb-2"},s.a.createElement(f.a,null,s.a.createElement(b,{type:"createTask"}),s.a.createElement(b,{type:"deleteTasks"}),s.a.createElement(b,{type:"logOut"}))),s.a.createElement(S,null)):s.a.createElement("div",null,s.a.createElement("h1",{id:"site_name"},"Task list")," ",s.a.createElement(O,null),s.a.createElement(N,null))}document.getElementById("modal").hidden=!0,setInterval(function(){r.a.render(s.a.createElement(D,null),document.getElementById("root"))},500)}},[[49,2,1]]]);
//# sourceMappingURL=main.0be6d68f.chunk.js.map