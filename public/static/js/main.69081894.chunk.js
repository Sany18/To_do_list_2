(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),l=a(23),r=a.n(l),o=a(9),c=a(10),i=a(13),u=a(11),m=a(12),d=a(14),h={API:"",ENV:"test"},g={root:h.API,tasksGet:h.API+"/tasks",taskCreatePost:h.API+"/tasks/",taskShowGet:h.API+"/tasks/",taskUpdatePut:h.API+"/tasks/",taskUpdatePatch:h.API+"/tasks/",taskDelete:h.API+"/tasks/",deleteSelected:h.API+"/tasks/delete_selected/",statusSwitchPOST:h.API+"/tasks/status_switch/",oauthTokenPOST:h.API+"/oauth/token/",userCreatePOST:h.API+"/user/create/"},p=a(19),k=a(16),f=a(122),E=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).emptyTaskKey=function(){return!isNaN(parseFloat(a.props.taskKey))&&isFinite(a.props.taskKey)},a.getDateNow=function(){var e=new Date;return t(e.getFullYear())+"-"+t(e.getMonth())+"-"+t(e.getDate());function t(e){return null===e?"x":e<10?"0"+e:e}},a.state={isLoading:!1,error:null,tasks:[],taskKey:a.props.taskKey,value:{id:"",title:"",theme:"",priority:0,due_date:""}},a.handleChange=a.handleChange.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.setState({value:Object(k.a)({},this.state.value,{due_date:this.getDateNow()})}),this.emptyTaskKey()){var t="access_token="+localStorage.getItem("access_token");fetch(g.tasksGet+"?"+t).then(function(e){return e.json()}).then(function(t){return e.setState({tasks:t,isLoading:!0})}).then(function(t){var a=e.state.tasks[e.state.taskKey];e.setState({value:Object(k.a)({},e.state.value,{title:a.title})}),e.setState({value:Object(k.a)({},e.state.value,{theme:a.theme})}),e.setState({value:Object(k.a)({},e.state.value,{due_date:a.due_date})}),e.setState({value:Object(k.a)({},e.state.value,{id:a.id})})}).catch(function(t){return e.setState({error:t})})}}},{key:"handleChange",value:function(e){var t=e.target.value;this.setState({value:Object(k.a)({},this.state.value,Object(p.a)({},e.target.name,t))})}},{key:"render",value:function(){var e=this.state.tasks[this.state.taskKey]||this.state.value;return this.state.isLoading||!this.emptyTaskKey()?s.a.createElement("div",null,s.a.createElement("label",null,"Theme"),s.a.createElement("input",{defaultValue:e.title,name:"title",onChange:this.handleChange}),s.a.createElement("label",null,"Task"),s.a.createElement("textarea",{defaultValue:e.theme,name:"theme",onChange:this.handleChange}),s.a.createElement("label",null,"Due date"),s.a.createElement("input",{type:"date",defaultValue:e.due_date||this.getDateNow(),min:this.getDateNow(),name:"due_date",onChange:this.handleChange}),s.a.createElement(f.a,null,e.id?s.a.createElement(y,{type:"deleteTask",params:e.id}):"",s.a.createElement(y,{type:"closeTask"}),+this.state.value.id?s.a.createElement(y,{type:"updateTask",params:this.state.value}):s.a.createElement(y,{type:"saveTask",params:this.state.value}))):this.state.error?(document.getElementById("notice").innerHTML=this.state.error.toString(),null):null}}]),t}(n.Component),v=a(121),T=a(20),y=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),c=0;c<n;c++)l[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={isLoading:!1,error:null,resp:[],type:null},a.ajaxTo=function(e,t,n){var s={method:n,headers:{"Content-Type":"application/json"},body:a.getTokensBody(t)};"test"===h.ENV&&console.log("request: ",s),"test"===h.ENV&&console.log("to: ",e),fetch(e,s).then(function(e){return e.json()}).then(function(e){e.access_token&&localStorage.setItem("access_token",e.access_token),e.error&&T.NotificationManager.info(e.error,"",3e3),"test"===h.ENV&&console.log("response: ",e),a.refreshTasks()}).catch(function(e){return a.setState({error:e})})},a.getTokensBody=function(e){return"password"===e.grant_type?JSON.stringify(e):localStorage.getItem("access_token")?(e.access_token=localStorage.getItem("access_token"),JSON.stringify(e)):JSON.stringify({access_token:localStorage.getItem("access_token")})},a.openNewTaskModal=function(){a.openTaskInModal(!1)},a.openTaskInModal=function(e){a.hideModal(),document.getElementById("modal").hidden=!1;var t=document.createElement("div");document.getElementById("modal").appendChild(t),r.a.render(s.a.createElement(E,{taskKey:e}),t)},a.hideModal=function(){if(!document.getElementById("modal").hidden){var e=document.getElementById("modal");e.firstChild&&r.a.unmountComponentAtNode(e.firstChild),e.innerHTML="",e.hidden=!0}},a.saveTask=function(e){a.ajaxTo(g.taskCreatePost,{task:e},"POST"),a.hideModal()},a.updateTask=function(e){a.ajaxTo(g.taskUpdatePut+e.id,{task:e},"PUT"),a.hideModal()},a.login=function(e){localStorage.removeItem("deleteTasks"),e.grant_type="password",a.ajaxTo(g.oauthTokenPOST,e,"POST")},a.refreshTasks=function(){localStorage.setItem("taps",+localStorage.getItem("taps")+1)},a.deleteTask=function(e){window.confirm("Delete this task?")&&(a.ajaxTo(g.taskDelete+e,{},"DELETE"),a.hideModal())},a.signUp=function(e){e.grant_type="password",a.ajaxTo(g.userCreatePOST,e,"POST")},a.logOut=function(){T.NotificationManager.success("Log out sucesfuly","",3e3),localStorage.clear()},a.deleteTasks=function(){var e=localStorage.getItem("deleteTasks");a.ajaxTo(g.deleteSelected+e,{},"DELETE")},a.done=function(e){a.ajaxTo(g.statusSwitchPOST,{id:e},"POST")},a.getButton=function(e,t){switch(e){case"deleteTask":return s.a.createElement(v.a,{onClick:function(){return a.deleteTask(t)}},"Delete task");case"deleteTask2":return s.a.createElement(v.a,{onClick:function(){return a.deleteTask(t)}},"\xd7");case"deleteTasks":return s.a.createElement(v.a,{onClick:function(){return a.deleteTasks()}},"Delete selected");case"editTask":return s.a.createElement(v.a,{onClick:function(){return a.openTaskInModal(t)}},"Edit");case"createTask":case"newTask":return s.a.createElement(v.a,{id:"newTask",bsStyle:"default",onClick:function(){return a.openNewTaskModal()}},"New task");case"closeTask":return s.a.createElement(v.a,{id:"closeTask",onClick:function(){return a.hideModal()}},"Close");case"saveTask":return s.a.createElement(v.a,{onClick:function(){return a.saveTask(t)}},"Save");case"updateTask":return s.a.createElement(v.a,{onClick:function(){return a.updateTask(t)}},"Update");case"signUp":return s.a.createElement(v.a,{onClick:function(){return a.signUp(t)}},"Sign up");case"signIn":return s.a.createElement(v.a,{onClick:function(){return a.login(t)}},"Login");case"logOut":return s.a.createElement(v.a,{onClick:function(){return a.logOut()}},"Log out");case"done":return s.a.createElement(v.a,{onClick:function(){return a.done(t)}},"Done");case"notDone":return s.a.createElement(v.a,{onClick:function(){return a.done(t)}},"Not done");default:return T.NotificationManager.warning("Button is undefined","",3e3),null}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(f.a,{bsSize:"small"},this.getButton(this.props.type,this.props.params))}}]),t}(n.Component),b=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).getTasks=function(){var e="access_token="+localStorage.getItem("access_token");fetch(g.tasksGet+"?"+e).then(function(e){return e.json()}).then(function(e){a.sortFunction(e)}).catch(function(e){return a.setState({error:e})})},a.handleClick=function(){a.setState({isOpen:!a.state.isOpen})},a.cutDate=function(e){return null===e?"free":e.substr(0,10)},a.sortFunction=function(e){for(var t in e)!0===e[t]["is_done?"]?a.state.doneTasks.push(e[t]):a.state.notDoneTasks.push(e[t]);a.setState({isLoading:!0})},a.state={isLoading:!1,error:null,isOpen:!1,doneTasks:[],notDoneTasks:[],taps:0,selected:[]},a.handleInputChange=a.handleInputChange.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){if(this.state.taps!==+localStorage.getItem("taps")){this.setState({doneTasks:[],notDoneTasks:[]}),this.getTasks(),"test"===h.ENV&&console.log("update!"),this.setState({taps:+localStorage.getItem("taps")});for(var e=document.getElementsByClassName("ch"),t=0;t<e.length;t++)e[t].checked=!1}}},{key:"componentDidMount",value:function(){this.getTasks(),this.setState({taps:+localStorage.getItem("taps")})}},{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name,s=this.state.selected;if(a){for(var l=!0,r=0;r<s.length;r++)s[r]===n&&(l=!1);l&&(s.push(n),this.setState({selected:s}))}else if(!a)for(var o=0;o<s.length;o++)s[o]===n&&(delete s[o],this.setState({selected:s.filter(Boolean)}));localStorage.setItem("deleteTasks",this.state.selected.join("&"))}},{key:"render",value:function(){var e=this;return this.state.isLoading&&!this.state.error&&(this.state.doneTasks.length||this.state.notDoneTasks.length)?s.a.createElement("div",{id:"tasks"},s.a.createElement("div",{className:"task notDoneTasks"},this.state.notDoneTasks.map(function(t,a){return s.a.createElement("ul",{className:"list-group task",key:a},s.a.createElement("li",{className:"list-group-item mr-2 list-group-item-secondary"},s.a.createElement("div",{className:"float-left"},s.a.createElement("input",{name:t.id,type:"checkbox",className:"ch",onChange:e.handleInputChange}),s.a.createElement("b",null,t.title),s.a.createElement("br",null),t.theme),s.a.createElement("div",{className:"text-right float-right"},s.a.createElement("div",{className:"d-inline"},"Due date: ",e.cutDate(t.due_date)," "),s.a.createElement(f.a,null,s.a.createElement(y,{type:"done",params:t.id}),s.a.createElement(y,{type:"editTask",params:a}),s.a.createElement(y,{type:"deleteTask2",params:t.id})))))})),s.a.createElement("hr",{align:"center",color:"Red"}),s.a.createElement("div",{className:"task doneTasks"},this.state.doneTasks.map(function(t,a){return s.a.createElement("ul",{className:"list-group task",key:a},s.a.createElement("li",{className:"list-group-item mr-2 list-group-item-success"},s.a.createElement("div",{className:"float-left"},s.a.createElement("input",{name:t.id,type:"checkbox",className:"ch",onChange:e.handleInputChange}),s.a.createElement("b",null,t.title),s.a.createElement("br",null),t.theme),s.a.createElement("div",{className:"text-right float-right"},s.a.createElement("div",{className:"d-inline"},"Due date: ",e.cutDate(t.due_date)," "),s.a.createElement(f.a,null,s.a.createElement(y,{type:"notDone",params:t.id}),s.a.createElement(y,{type:"editTask",params:a}),s.a.createElement(y,{type:"deleteTask2",params:t.id})))))}))):!this.state.isLoading||this.state.doneTasks.length||this.state.notDoneTasks.length||this.state.error?this.state.isLoading&&this.state.error?(T.NotificationManager.info(this.state.error.toString(),"",3e3),null):s.a.createElement("div",null,s.a.createElement("p",null,"Wait")):s.a.createElement("div",null,s.a.createElement("p",null,"Creare you first task"))}}]),t}(n.Component),S=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={timer:"",currentTime:""},a.getTime=function(){var e=(new Date).toLocaleTimeString()+" "+(new Date).toLocaleDateString();a.setState({currentTime:e})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=setInterval(this.getTime,1e3);this.setState({timer:e})}},{key:"render",value:function(){return s.a.createElement("h2",{className:"mr-2",id:"clock"},"Now is ",this.state.currentTime)}}]),t}(n.Component),O=a(123),C=a(129),j=a(124),I=a(126),N=a(125),w=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={isLoading:!0,error:null,tasks:[],value:{email:"",password:""}},a.handleChange=a.handleChange.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){var t=e.target.value;this.setState({value:Object(k.a)({},this.state.value,Object(p.a)({},e.target.name,t))})}},{key:"render",value:function(){return this.state.isLoading?s.a.createElement("div",null,s.a.createElement(O.a,null,s.a.createElement(C.a,{controlId:"formInlineMail2"},s.a.createElement(j.a,null,"Email"),s.a.createElement(I.a,{bsSize:"small",type:"text",name:"email",placeholder:"email",onChange:this.handleChange})),s.a.createElement(C.a,{controlId:"formInlinePass2"},s.a.createElement(j.a,null,"Password"),s.a.createElement(I.a,{bsSize:"small",name:"password",type:"password",placeholder:"password",onChange:this.handleChange})),s.a.createElement(f.a,null,s.a.createElement(y,{type:"signIn",params:this.state.value}),s.a.createElement(N.a,{to:"/registration"},s.a.createElement(v.a,{bsSize:"small"},"Sign up"))))):this.state.error?(document.getElementById("notice").innerHTML=this.state.error.toString(),null):void 0}}]),t}(n.Component),D=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={isLoading:!0,error:null,tasks:[],value:{email:"",password:"",confirm_password:"",last_name:"",first_name:""}},a.handleChange=a.handleChange.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){var t=e.target.value;this.setState({value:Object(k.a)({},this.state.value,Object(p.a)({},e.target.name,t))})}},{key:"render",value:function(){return this.state.isLoading?s.a.createElement("div",null,s.a.createElement(O.a,null,s.a.createElement(C.a,{controlId:"formInlineEmail"},s.a.createElement(j.a,null,"Email"),s.a.createElement(I.a,{bsSize:"small",name:"email",type:"email",placeholder:"email",onChange:this.handleChange})),s.a.createElement(C.a,{controlId:"formInlinePass"},s.a.createElement(j.a,null,"Password"),s.a.createElement(I.a,{bsSize:"small",name:"password",type:"password",placeholder:"password",onChange:this.handleChange})),s.a.createElement(C.a,{controlId:"formInlineConfirmPass"},s.a.createElement(j.a,null,"Confirm password"),s.a.createElement(I.a,{bsSize:"small",name:"confirm_password",type:"password",placeholder:"confirm password",onChange:this.handleChange})),s.a.createElement(C.a,{controlId:"formInlineName"},s.a.createElement(j.a,null,"Your name"),s.a.createElement(I.a,{bsSize:"small",name:"first_name",type:"text",placeholder:"name",onChange:this.handleChange})),s.a.createElement(C.a,{controlId:"formInline2Name"},s.a.createElement(j.a,null,"Last name"),s.a.createElement(I.a,{bsSize:"small",name:"last_name",type:"text",placeholder:"last name",onChange:this.handleChange})),s.a.createElement(f.a,null,s.a.createElement(y,{type:"signUp",params:this.state.value}),s.a.createElement(N.a,{to:"/"},s.a.createElement(v.a,{bsSize:"small"},"Login"))))):this.state.error?(document.getElementById("notice").innerHTML=this.state.error.toString(),null):void 0}}]),t}(n.Component),_=(a(114),a(116),a(127)),P=a(128),L=(a(54),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={token:localStorage.access_token,timer:""},a.setToken=function(){a.setState({token:localStorage.access_token})},a.main=function(){return a.state.token?s.a.createElement("div",null,s.a.createElement("div",{className:"mb-2"},s.a.createElement(f.a,null,s.a.createElement(y,{type:"createTask"}),s.a.createElement(y,{type:"deleteTasks"}),s.a.createElement(y,{type:"logOut"}))),s.a.createElement(b,null)):s.a.createElement("div",{className:"col-5"},s.a.createElement("h3",null,"Sing in"),s.a.createElement(w,null))},a.registration=function(){return s.a.createElement("div",{className:"col-5"},s.a.createElement("h3",null,"Registration"),s.a.createElement(D,null))},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.getElementById("modal")&&(document.getElementById("modal").hidden=!0);var e=setInterval(this.setToken,500);this.setState({timer:e}),"test"===h.ENV&&console.log("You are in a test environment")}},{key:"render",value:function(){return s.a.createElement("div",{className:"col-12"},s.a.createElement(T.NotificationContainer,null),s.a.createElement("h1",{id:"site_name",className:"mb-2 ml-2 mr-2"},"Task list")," ",s.a.createElement(S,null),s.a.createElement(_.a,null,s.a.createElement("div",null,s.a.createElement(P.a,{exact:!0,path:"/",component:this.main}),s.a.createElement(P.a,{path:"/registration",component:this.registration}))))}}]),t}(n.Component));r.a.render(s.a.createElement(L,null),document.getElementById("root")||document.createElement("div"))},54:function(e,t,a){},62:function(e,t,a){e.exports=a(120)}},[[62,2,1]]]);
//# sourceMappingURL=main.69081894.chunk.js.map